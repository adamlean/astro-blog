---
import { getCollection, getEntryBySlug } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";

// получаем slug из роута
export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;

const { Content } = await post.render();
---

<Layout>
  <Header />
  <article class="blog-post">
    <img src={post.data.image} alt={post.data.title} class="post-image" />

    <h1>{post.data.title}</h1>
    <p class="post-meta">
      {
        post.data.pubDate.toLocaleDateString("en-US", {
          year: "numeric",
          month: "long",
          day: "numeric",
        })
      } | {post.data.category}
    </p>

    <div class="post-tags">
      {post.data.tags.map((tag) => <span class="post-tag">{tag}</span>)}
    </div>

    <p class="description">{post.data.description}</p>

    <div class="post-body">
      <Content />
    </div>
  </article>
  <Footer />
</Layout>
